# VulnHub - 41-Brainpan

üìÖ –î–∞—Ç–∞: 2025-05-22  
üß† –°–ª–æ–∂–Ω–æ—Å—Ç—å:  
üíª IP-–∞–¥—Ä–µ—Å: 192.168.56.123  

---

## üîç –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
export ip=192.168.56.123
export ports=9999,10000
sudo nmap -sT -Pn -sV -T4 -A -p $ports $ip -oN scans/nmap.txt
```

üñºÔ∏è Nmap —Å–∫–∞–Ω:

![nmap scan](screenshots/nmap_scan.png)

---

## üïµÔ∏è Enumeration
```bash
‚îå‚îÄ‚îÄ(kali„âø0x2d-pentest)-[~/Labs/VulnHub]
‚îî‚îÄ$ ffuf -fc 404 -t 100 -u http://$ip:10000/FUZZ -w /media/sf_Exchange/Dictionaries/Dir/directory-list-2.3-medium.txt
bin                     [Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 18ms]
```
![brainpan scan](screenshots/brainpan.exe.png)

–ó–∞–≥—Ä—É–∂–∞—é –≤ Ghidra
![ghidra 1](screenshots/gh1.png)

–í–∏–∂—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—Ç–∫–∞–∑–∞ –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞:
```bash
  local_404 = "                          ACCESS DENIED\n";
  local_408 = "                          ACCESS GRANTED\n";
```
–í –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é **char local_3fc [1016];** —Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ (1000 –±–∞–π—Ç) -> –∑–∞—Ç–∏—Ä–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ –Ω–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å

–§—É–Ω–∫—Ü–∏—è **get_reply(local_3fc)** –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç –∫–∞–∫—É—é-—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫—É –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **0**, –µ—Å–ª–∏ –æ–Ω–∞ —É—Å–ø–µ—à–Ω–∞.

–ò–¥—É –≤ —Ñ—É–Ω–∫—Ü–∏—é **get_reply()**:
![ghidra 2](screenshots/gh2.png)

–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `shitstorm` –Ω–∏—á–µ–≥–æ –Ω–µ –¥–∞–ª–æ:  
![ghidra 3](screenshots/gh3.png)

–¢–∞–∫ —á—Ç–æ —Å–º–æ—Ç—Ä—é –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞: param_1 [1000 –±–∞–π—Ç] –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é local_20c [520 –±–∞–π—Ç]

–°—Ç–µ–∫ —Ñ—É–Ω–∫—Ü–∏–∏ `get_reply(char * param_1)` –∏–º–µ–µ—Ç —Ç–∞–∫–æ–π –≤–∏–¥:
```
                             **************************************************************
                             * get_reply                                                  *
                             **************************************************************
                             undefined __cdecl get_reply(char * param_1)
             undefined         <UNASSIGNED>        <RETURN>
             char *            Stack[0x4]:4        param_1                                 XREF[2]:     31171305(R), 
             undefined1        Stack[-0x20c]:520   local_20c                               XREF[3]:     3117131f(*), 
```
`param_1` - —ç—Ç–æ 32 –±–∏—Ç–Ω—ã–π —É–∫–∞–∑–∞—Ç–µ–ª—å (char *), –¥–ª–∏–Ω–æ–π 4 –±–∞–π—Ç–∞, –¥–∞–ª–µ–µ –∏–¥–µ—Ç EBP (—Ç–æ–∂–µ 4 –±–∞–π—Ç–∞ –≤ 32 –±–∏—Ç–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ) –∏ –∞–¥—Ä–µ—Å –≤–æ–∑–≤—Ä–∞—Ç–∞.  
  
—Ç.–µ. –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞, –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `local_20c` –Ω—É–∂–Ω–æ –ø–æ–ª–æ–∂–∏—Ç—å 520 –±–∞–π—Ç,  
—Å–ª–µ–¥—É—é—â–∏–µ 4 –±–∞–π—Ç–∞ –ø–µ—Ä–µ–∑–∞–ø–∏—à—É—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å `param_1`,  
–µ—â—ë 4 –±–∞–π—Ç–∞ –ø–µ—Ä–µ–∑–∞–ø–∏—à—É—Ç `EBP`,  
–∏ –µ—â—ë 4 –±–∞–π—Ç–∞ –ø–µ—Ä–µ–∑–∞–ø–∏—à—É—Ç `return adress`  
  
–ò—Ç–æ–≥–æ: **520**(local_20c) + **4**(param_1) + **4**(EBP) + **4**(return)

–¢–æ–∂–µ —Å–∞–º–æ–µ –º–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å –ø–æ `Stack[-0x20c]:520   local_20c`.
Ghidra —É–∫–∞–∑—ã–≤–∞–µ—Ç —Å–º–µ—â–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ EBP: `EBP-0x20c`.
`0x20c` = `524` –≤ –¥–µ—Å—è—Ç–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ
<img width="646" height="268" alt="image" src="https://github.com/user-attachments/assets/ff1ab201-d2aa-41d1-8145-532468db6179" />

  
```bash
[EBP - 0x20C] local_20c      (520 –±–∞–π—Ç)
[EBP - 0x218] local_218      (4 –±–∞–π—Ç–∞)
[EBP - 0x21C] local_21c      (4 –±–∞–π—Ç–∞)
[EBP + 0x00] saved EBP       (4 –±–∞–π—Ç–∞)
[EBP + 0x04] return address  (4 –±–∞–π—Ç–∞)
```

–ù—É–∂–Ω–æ –∑–∞–ø–∏—Å–∞—Ç—å 200*NOP + payload + 



## üìÇ –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞



## ‚öôÔ∏è –ü—Ä–∏–≤–∏–ª–µ–≥–∏–∏



## üèÅ –§–ª–∞–≥–∏

- User flag: 
- Root flag: 

---

## üìã –†–µ–∑—é–º–µ

üß∞ **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
  - nmap, ffuf, –∏ –¥—Ä.

üö® **–£—è–∑–≤–∏–º–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å:**  
  - Directory Traversal  
  - RCE —á–µ—Ä–µ–∑ —É—è–∑–≤–∏–º—ã–π —Å–∫—Ä–∏–ø—Ç  

üõ° **–°–æ–≤–µ—Ç—ã –ø–æ –∑–∞—â–∏—Ç–µ:**
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —á–∏—Å–ª–æ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
  - –û–±–Ω–æ–≤–ª—è—Ç—å –ü–û –¥–æ –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –≤–µ—Ä—Å–∏–π
  - –£–¥–∞–ª—è—Ç—å/–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SUID-–±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤
  - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
  - –ü—Ä–∏–º–µ–Ω—è—Ç—å –ø—Ä–∏–Ω—Ü–∏–ø –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π


